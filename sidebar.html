function loadSidebar() {
    fetch(getSidebarPath())
        .then(response => response.text())
        .then(data => {
            document.getElementById('sidebar').innerHTML = data;
            // 모든 토글 요소에 이벤트 리스너 추가
            addToggleListeners();
        })
        .catch(error => console.error('Error loading sidebar:', error));
}

function addToggleListeners() {
    // 카테고리와 서브카테고리 토글에 이벤트 리스너 추가
    document.querySelectorAll('.category-toggle, .subcategory-toggle').forEach(toggle => {
        toggle.addEventListener('click', function(event) {
            event.stopPropagation(); // 이벤트 버블링 방지
            this.textContent = this.textContent === '▶' ? '▼' : '▶';
            // 다음 형제 요소 중 .subcategory 또는 .subsubcategory 클래스를 가진 요소 토글
            const contentToToggle = this.nextElementSibling.nextElementSibling;
            if (contentToToggle && (contentToToggle.classList.contains('subcategory') || contentToToggle.classList.contains('subsubcategory'))) {
                contentToToggle.classList.toggle('hidden');
            }
        });
    });
}

// 페이지 로드 시 사이드바 로드
document.addEventListener('DOMContentLoaded', loadSidebar);
